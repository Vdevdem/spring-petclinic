pipeline {
    agent any

    stages {
        stage ('Checkout'){
          steps {
              cleanWs()
              git branch: 'main', credentialsId: 'Git_FProject', url: 'https://github.com/Vdevdem/spring-petclinic.git'
          }
         }

        stage('hello'){
          steps {
                echo 'hello'
            }
          }

        stage('build') {
          steps {
                echo 'Build Start'

                bat"""
                rem git clone https://github.com/Vdevdem/spring-petclinic.git

                mvn package
                java -Dserver.port=8888 -jar target/*.jar
                """
               }
          }

          stage('Create Docker Container') {
              steps {
                  echo 'Start creating Docker Container'
                  bat"""
                  cd spring-petclinic 
                  ./mvnw spring-boot:build-image
                  docker tag petclinic docker:5000/petclinic:v$BUILD_NUMBER
                  docker push docker:5000/petclinic:v$BUILD_NUMBER
                  """
                  echo 'End creating Docker Container'
              }
          }
                                      
         
    }
}
